<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡´æˆ‘æœ€çˆ±çš„ä½  - å°ä¸å®å®</title>
    <!-- Favicon - è§£å†³404é—®é¢˜ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’•</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Noto+Serif+SC:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-pink: #fff0f3;
            --bg-blue: #e8f4f8;
            --accent-pink: #e91e63;
            --accent-rose: #ff6b9d;
            --accent-blue: #5eb3c4;
            --accent-teal: #4db6ac;
            --text-dark: #2d3436;
            --text-soft: #636e72;
            --card-bg: rgba(255, 255, 255, 0.92);
            --orb-1-color: #ffb6c1;
            --orb-2-color: #87ceeb;
            --orb-3-color: #ffc0cb;
            --footer-bg: linear-gradient(135deg, rgba(255, 182, 193, 0.2), rgba(93, 179, 196, 0.1));
        }

        /* æ·±è‰²ä¸»é¢˜å˜é‡ */
        [data-theme="dark"] {
            --bg-pink: #1a1a2e;
            --bg-blue: #16213e;
            --accent-pink: #ff6b9d;
            --accent-rose: #ff8fab;
            --accent-blue: #4fc3dc;
            --accent-teal: #26d0ce;
            --text-dark: #f0f0f0;
            --text-soft: #b0b0b0;
            --card-bg: rgba(30, 30, 50, 0.95);
            --orb-1-color: #ff6b9d;
            --orb-2-color: #4fc3dc;
            --orb-3-color: #9d4edd;
            --footer-bg: linear-gradient(135deg, rgba(255, 107, 157, 0.15), rgba(79, 195, 220, 0.1));
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Serif SC', serif;
            min-height: 100vh;
            overflow-x: hidden;
            background: linear-gradient(135deg, var(--bg-pink) 0%, var(--bg-blue) 50%, var(--bg-pink) 100%);
            transition: background 0.5s ease;
        }

        /* åŠ¨æ€èƒŒæ™¯ */
        .bg-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .gradient-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.6;
            animation: float 20s ease-in-out infinite;
            transition: background 0.5s ease;
        }

        .orb-1 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, var(--orb-1-color), transparent);
            top: -100px;
            left: -100px;
            animation-delay: 0s;
        }

        .orb-2 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, var(--orb-2-color), transparent);
            bottom: -150px;
            right: -150px;
            animation-delay: -7s;
        }

        .orb-3 {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, var(--orb-3-color), transparent);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation-delay: -14s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(30px, -30px) scale(1.05); }
            50% { transform: translate(-20px, 20px) scale(0.95); }
            75% { transform: translate(20px, 30px) scale(1.02); }
        }

        /* çˆ±å¿ƒé£˜è½ */
        .hearts-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .falling-heart {
            position: absolute;
            top: -50px;
            animation: fall linear forwards;
            opacity: 0.7;
        }

        .falling-heart svg {
            fill: var(--accent-rose);
            filter: drop-shadow(0 2px 4px rgba(233, 30, 99, 0.3));
        }

        @keyframes fall {
            0% {
                transform: translateY(0) rotate(0deg) scale(0.8);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(100vh) rotate(360deg) scale(0.6);
                opacity: 0;
            }
        }

        /* çƒŸèŠ±ç”»å¸ƒ */
        #fireworks-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        /* ä¸»é¢˜åˆ‡æ¢æŒ‰é’® */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: var(--card-bg);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .theme-toggle svg {
            width: 26px;
            height: 26px;
            transition: transform 0.5s ease;
        }

        .theme-toggle .sun-icon {
            fill: #ffd700;
            display: none;
        }

        .theme-toggle .moon-icon {
            fill: #6366f1;
            display: block;
        }

        [data-theme="dark"] .theme-toggle .sun-icon {
            display: block;
        }

        [data-theme="dark"] .theme-toggle .moon-icon {
            display: none;
        }

        /* ä¸»å†…å®¹ */
        .main-content {
            position: relative;
            z-index: 10;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px 80px;
        }

        /* æ ‡é¢˜ */
        .title-section {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 1.2s ease-out;
        }

        .main-title {
            font-family: 'Dancing Script', cursive;
            font-size: clamp(2.5rem, 8vw, 5rem);
            color: var(--accent-pink);
            text-shadow: 2px 2px 0 rgba(255, 107, 157, 0.2);
            margin-bottom: 10px;
            transition: color 0.5s ease;
        }

        .sub-title {
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: var(--accent-pink);
            letter-spacing: 3px;
            transition: color 0.5s ease;
        }

        /* è·³åŠ¨çš„çˆ±å¿ƒ */
        .heartbeat-container {
            margin: 20px 0;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .heartbeat-container:hover {
            transform: scale(1.1);
        }

        .heart-icon {
            width: 60px;
            height: 60px;
            animation: heartbeat 1.2s ease-in-out infinite;
        }

        .heart-icon svg {
            fill: var(--accent-pink);
            filter: drop-shadow(0 4px 15px rgba(233, 30, 99, 0.5));
            transition: fill 0.5s ease;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            15% { transform: scale(1.25); }
            30% { transform: scale(1); }
            45% { transform: scale(1.15); }
            60% { transform: scale(1); }
        }

        /* ä¿¡ä»¶å¡ç‰‡ */
        .letter-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.1),
                0 0 0 1px rgba(255, 255, 255, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 1);
            max-width: 800px;
            width: 100%;
            padding: 50px;
            margin: 20px;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 1.5s ease-out 0.5s backwards;
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        .letter-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-pink), var(--accent-blue), var(--accent-rose));
        }

        /* è£…é¥°è§’ */
        .corner-deco {
            position: absolute;
            width: 80px;
            height: 80px;
            opacity: 0.3;
            transition: border-color 0.5s ease;
        }

        .corner-deco.top-left {
            top: 15px;
            left: 15px;
            border-top: 2px solid var(--accent-rose);
            border-left: 2px solid var(--accent-rose);
            border-radius: 8px 0 0 0;
        }

        .corner-deco.bottom-right {
            bottom: 15px;
            right: 15px;
            border-bottom: 2px solid var(--accent-blue);
            border-right: 2px solid var(--accent-blue);
            border-radius: 0 0 8px 0;
        }

        /* ä¿¡ä»¶å¤´éƒ¨ */
        .letter-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px dashed rgba(233, 30, 99, 0.2);
        }

        .letter-date {
            font-size: 0.9rem;
            color: var(--text-soft);
            margin-bottom: 15px;
            transition: color 0.5s ease;
        }

        .letter-greeting {
            font-size: 1.5rem;
            color: var(--accent-pink);
            font-weight: 600;
            transition: color 0.5s ease;
        }

        /* "æŸ¥çœ‹ä¿¡ä»¶"æŒ‰é’®æ ·å¼ */
        .view-letter-btn {
            display: block;
            width: 100%;
            max-width: 280px;
            margin: 30px auto;
            padding: 16px 32px;
            background: linear-gradient(135deg, var(--accent-rose), var(--accent-pink));
            color: white;
            border: none;
            border-radius: 30px;
            font-family: 'Noto Serif SC', serif;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(233, 30, 99, 0.4);
            transition: all 0.3s ease;
            animation: pulse 2s ease-in-out infinite;
        }

        .view-letter-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 30px rgba(233, 30, 99, 0.5);
        }

        .view-letter-btn.hidden {
            display: none;
        }

        /* ä¿¡ä»¶å†…å®¹ */
        .letter-body {
            min-height: 300px;
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
            line-height: 2;
            font-size: 1.1rem;
            color: var(--text-dark);
            transition: color 0.5s ease;
        }

        /* ä¿¡ä»¶åˆå§‹éšè—çŠ¶æ€ */
        .letter-body.hidden {
            display: none;
        }

        .letter-body.visible {
            display: block;
            animation: fadeInUp 0.8s ease-out;
        }

        .letter-body::-webkit-scrollbar {
            width: 6px;
        }

        .letter-body::-webkit-scrollbar-track {
            background: rgba(233, 30, 99, 0.1);
            border-radius: 3px;
        }

        .letter-body::-webkit-scrollbar-thumb {
            background: linear-gradient(var(--accent-rose), var(--accent-pink));
            border-radius: 3px;
        }

        .letter-content {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .typing-cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background: var(--accent-pink);
            margin-left: 2px;
            animation: blink 0.8s infinite;
            vertical-align: text-bottom;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* ä¿¡ä»¶ç»“å°¾ */
        .letter-footer {
            margin-top: 40px;
            text-align: right;
            padding-top: 20px;
            border-top: 1px dashed rgba(233, 30, 99, 0.2);
        }

        .signature {
            font-family: 'Dancing Script', cursive;
            font-size: 2rem;
            color: var(--accent-pink);
            transition: color 0.5s ease;
        }

        .postscript {
            margin-top: 30px;
            padding: 20px;
            background: var(--footer-bg);
            border-radius: 12px;
            font-style: italic;
            color: var(--text-soft);
            transition: background 0.5s ease, color 0.5s ease;
        }

        /* æ§åˆ¶æŒ‰é’® */
        .controls {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .control-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: 30px;
            font-family: 'Noto Serif SC', serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn svg {
            width: 20px;
            height: 20px;
        }

        .btn-music {
            background: linear-gradient(135deg, var(--accent-rose), var(--accent-pink));
            color: white;
            box-shadow: 0 4px 15px rgba(233, 30, 99, 0.4);
        }

        .btn-music:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(233, 30, 99, 0.5);
        }

        .btn-firework {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-teal));
            color: white;
            box-shadow: 0 4px 15px rgba(94, 179, 196, 0.4);
        }

        .btn-firework:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(94, 179, 196, 0.5);
        }

        .btn-replay {
            background: var(--card-bg);
            color: var(--accent-pink);
            border: 2px solid var(--accent-rose);
        }

        .btn-replay:hover {
            background: var(--accent-rose);
            color: white;
        }

        /* åŠ¨ç”» */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* åº•éƒ¨æç¤º */
        .hint-text {
            margin-top: 40px;
            text-align: center;
            color: var(--text-soft);
            font-size: 1.1rem;
            animation: pulse 2s ease-in-out infinite;
            transition: color 0.5s ease;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .letter-card {
                padding: 30px 20px;
                margin: 10px;
            }
            
            .letter-body {
                max-height: 400px;
                font-size: 1rem;
            }

            .controls {
                flex-direction: column;
                align-items: center;
            }

            .control-btn {
                width: 100%;
                max-width: 200px;
                justify-content: center;
            }

            .theme-toggle {
                top: 10px;
                right: 10px;
                width: 44px;
                height: 44px;
            }
        }

        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* éŸ³ä¹æ’­æ”¾çŠ¶æ€ */
        .music-playing {
            animation: musicPulse 1s ease-in-out infinite;
        }

        @keyframes musicPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* æ·±è‰²æ¨¡å¼ä¸‹çƒŸèŠ±æ›´ç»šä¸½ */
        [data-theme="dark"] #fireworks-canvas {
            mix-blend-mode: screen;
        }
    </style>
</head>
<body>
    <!-- åŠ¨æ€èƒŒæ™¯å±‚ -->
    <div class="bg-layer">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
    </div>

    <!-- çˆ±å¿ƒé£˜è½å®¹å™¨ -->
    <div class="hearts-container" id="hearts-container"></div>

    <!-- çƒŸèŠ±ç”»å¸ƒ -->
    <canvas id="fireworks-canvas"></canvas>

    <!-- ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
    <button class="theme-toggle" id="theme-toggle" title="åˆ‡æ¢ä¸»é¢˜">
        <!-- å¤ªé˜³å›¾æ ‡ - æ·±è‰²æ¨¡å¼ä¸‹æ˜¾ç¤º -->
        <svg class="sun-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0-5a1 1 0 0 1 1 1v2a1 1 0 1 1-2 0V3a1 1 0 0 1 1-1zm0 18a1 1 0 0 1 1 1v2a1 1 0 1 1-2 0v-2a1 1 0 0 1 1-1zm9-9a1 1 0 0 1-1 1h-2a1 1 0 1 1 0-2h2a1 1 0 0 1 1 1zM5 12a1 1 0 0 1-1 1H2a1 1 0 1 1 0-2h2a1 1 0 0 1 1 1zm14.071-7.071a1 1 0 0 1 0 1.414l-1.414 1.414a1 1 0 1 1-1.414-1.414l1.414-1.414a1 1 0 0 1 1.414 0zM7.757 16.243a1 1 0 0 1 0 1.414L6.343 19.07a1 1 0 1 1-1.414-1.414l1.414-1.414a1 1 0 0 1 1.414 0zM19.07 19.07a1 1 0 0 1-1.414 0l-1.414-1.414a1 1 0 1 1 1.414-1.414l1.414 1.414a1 1 0 0 1 0 1.414zM7.757 7.757a1 1 0 0 1-1.414 0L4.93 6.343A1 1 0 0 1 6.343 4.93l1.414 1.414a1 1 0 0 1 0 1.414z"/>
        </svg>
        <!-- æœˆäº®å›¾æ ‡ - æµ…è‰²æ¨¡å¼ä¸‹æ˜¾ç¤º -->
        <svg class="moon-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"/>
        </svg>
    </button>

    <!-- ä¸»å†…å®¹ -->
    <main class="main-content">
        <!-- æ ‡é¢˜åŒº -->
        <section class="title-section">
            <h1 class="main-title">To My Dearest</h1>
            <p class="sub-title">æƒ…äººèŠ‚å¿«ä¹ï¼</p>
        </section>

        <!-- è·³åŠ¨çˆ±å¿ƒ -->
        <div class="heartbeat-container" id="heart-trigger" title="ç‚¹å‡»è§¦å‘çƒŸèŠ±">
            <div class="heart-icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                </svg>
            </div>
        </div>

        <!-- ä¿¡ä»¶å¡ç‰‡ -->
        <article class="letter-card">
            <div class="corner-deco top-left"></div>
            <div class="corner-deco bottom-right"></div>

            <header class="letter-header">
                <p class="letter-date">å†™äº äºŒæœˆåå››æ—¥ æƒ…äººèŠ‚</p>
                <h2 class="letter-greeting">äº²çˆ±çš„å°ä¸å®è´ï¼š</h2>
            </header>

            <!-- "ç‚¹å‡»æŸ¥çœ‹ä¿¡ä»¶"æŒ‰é’® -->
            <button class="view-letter-btn" id="view-letter-btn">ğŸ’Œ ç‚¹å‡»æŸ¥çœ‹ä¿¡ä»¶</button>

            <div class="letter-body hidden" id="letter-body">
                <div class="letter-content" id="letter-content">
                    <!-- ä¿¡ä»¶å†…å®¹å°†é€šè¿‡æ‰“å­—æœºæ•ˆæœæ˜¾ç¤º -->
                    <span class="typing-cursor" id="typing-cursor"></span> <!-- å…‰æ ‡è·Ÿéšæ‰“å­— -->
                </div>
            </div>

            <footer class="letter-footer">
                <p class="signature">æ°¸è¿œçˆ±ä½ çš„ä¸»äºº</p>
                <p style="font-family: 'Dancing Script', cursive; font-size: 2.5rem; color: var(--accent-pink);">Your Love</p>
            </footer>

            <div class="postscript">
                <p>P.S. ç‚¹å‡»é¡µé¢è¾¹ç¼˜ å’Œ ä¸Šæ–¹çš„çˆ±å¿ƒï¼Œç¨ç­‰ç‰‡åˆ»ï¼Œä¼šæœ‰æƒŠå–œå“¦~</p>
            </div>

        </article>

        <!-- æ§åˆ¶æŒ‰é’® -->
        <div class="controls">
            <button class="control-btn btn-music" id="music-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18V5l12-2v13"/>
                    <circle cx="6" cy="18" r="3"/>
                    <circle cx="18" cy="16" r="3"/>
                </svg>
                <span>æš‚åœéŸ³ä¹</span>
            </button>
            <button class="control-btn btn-firework" id="firework-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
                </svg>
                <span>æ”¾çƒŸèŠ±</span>
            </button>
            <button class="control-btn btn-replay" id="replay-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 4v6h6M23 20v-6h-6"/>
                    <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
                </svg>
                <span>é‡æ’­ä¿¡ä»¶</span>
            </button>
        </div>

        <p class="hint-text">* ç‚¹å‡»é¡µé¢è¾¹ç¼˜ï¼Œç¨ç­‰ç‰‡åˆ»ï¼Œç»½æ”¾çˆ±çš„çƒŸç« *</p>
    </main>

    <!-- èƒŒæ™¯éŸ³ä¹ -->
    <audio id="bg-music" loop autoplay>
        <!-- 
            ==========================================
            è¯·å°†æ‚¨çš„éŸ³ä¹æ–‡ä»¶æ”¾åœ¨ä¸‹æ–¹ src ä¸­
            æ”¯æŒæ ¼å¼: MP3, OGG, WAV
            ç¤ºä¾‹: 
            <source src="your-music.mp3" type="audio/mpeg">
            æˆ–ä½¿ç”¨åœ¨çº¿éŸ³ä¹é“¾æ¥
        ========================================== -->
        <source src="music.mp3" type="audio/mpeg">
    </audio>

    <script>
        // ==========================================
        // åœ¨è¿™é‡Œç¼–å†™ä½ çš„æƒ…ä¹¦å†…å®¹
        // å¯ä»¥å†™å¾—å¾ˆé•¿ï¼Œæ‰“å­—æœºä¼šè‡ªåŠ¨æ˜¾ç¤º
        // æ³¨æ„ï¼šé¦–è¡Œä¸è¦æœ‰ç¼©è¿›ï¼Œå¦åˆ™æ‰“å­—å¼€å¤´ä¼šå‡ºç°å¤šä½™ç©ºæ ¼
        // ==========================================
        const loveLetter = `ä»Šå¤©æ˜¯æƒ…äººèŠ‚ï¼Œæˆ‘æƒ³ç”¨è¿™å°ä¿¡ï¼ŒæŠŠå¹³æ—¶è¯´ä¸å‡ºå£çš„è¯éƒ½å‘Šè¯‰ä½ ã€‚

è¿˜è®°å¾—æˆ‘ä»¬ç¬¬ä¸€æ¬¡è§é¢å—ï¼Ÿé‚£æ—¶å€™æˆ‘å°±è§‰å¾—ï¼Œè¿™ä¸ªç”·å­©å¥½ç‰¹åˆ«ï¼Œä»–çš„ç¬‘å®¹åƒé˜³å…‰ä¸€æ ·æ¸©æš–ï¼Œè®©äººå¿ä¸ä½æƒ³è¦é è¿‘ã€‚

åæ¥æˆ‘ä»¬åœ¨ä¸€èµ·äº†ï¼Œæ¯ä¸€å¤©éƒ½åƒæ˜¯è¢«ä¸Šå¤©çœ·é¡¾ç€ã€‚ä½ çš„æ¯ä¸€ä¸ªå°è¡¨æƒ…ã€æ¯ä¸€æ¬¡æ’’å¨‡ã€æ¯ä¸€å¥å…³å¿ƒçš„è¯ï¼Œæˆ‘éƒ½çè—åœ¨å¿ƒé‡Œæœ€æŸ”è½¯çš„åœ°æ–¹ã€‚

æˆ‘å–œæ¬¢çœ‹ç€ä½ åƒä¸œè¥¿æ—¶æ»¡è¶³çš„æ ·å­ï¼Œå–œæ¬¢ä½ è®¤çœŸå­¦ä¹ æ—¶å¾®å¾®çš±èµ·çš„çœ‰å¤´ï¼Œå–œæ¬¢ä½ åœ¨é˜³å…‰ä¸‹çœ¯ç€çœ¼ç›ç¬‘ï¼Œå–œæ¬¢ä½ çš„ä¸€åˆ‡ã€‚

è¿™ä¸€å¹´é‡Œï¼Œæˆ‘ä»¬ä¸€èµ·ç»å†äº†å¾ˆå¤šã€‚æœ‰è¿‡æ¬¢ç¬‘ï¼Œä¹Ÿæœ‰è¿‡å°äº‰åµï¼Œä½†æ¯ä¸€æ¬¡å’Œå¥½ï¼Œéƒ½è®©æˆ‘æ›´åŠ ç¡®å®šâ€”â€”ä½ å°±æ˜¯æˆ‘æƒ³è¦å®ˆæŠ¤ä¸€è¾ˆå­çš„äººã€‚

è°¢è°¢ä½ å‡ºç°åœ¨æˆ‘çš„ç”Ÿå‘½é‡Œï¼Œè®©æˆ‘çŸ¥é“äº†ä»€ä¹ˆæ˜¯çœŸæ­£çš„çˆ±æƒ…ã€‚è°¢è°¢ä½ åŒ…å®¹æˆ‘çš„ä¸å®Œç¾ï¼Œè°¢è°¢ä½ é™ªæˆ‘åº¦è¿‡æ¯ä¸€ä¸ªå¹³å‡¡åˆä¸å¹³å‡¡çš„æ—¥å­ã€‚

æˆ‘æƒ³å’Œä½ ä¸€èµ·çœ‹å¾ˆå¤šå¾ˆå¤šçš„æ—¥å‡ºæ—¥è½ï¼Œæƒ³ç‰µç€ä½ çš„æ‰‹èµ°è¿‡æ˜¥å¤ç§‹å†¬ï¼Œæƒ³åœ¨æœªæ¥çš„æ¯ä¸€å¤©é†’æ¥éƒ½èƒ½çœ‹åˆ°ä½ çš„ç¡é¢œã€‚

å®è´ï¼Œæˆ‘çˆ±ä½ ï¼Œä¸æ˜¯è¯´è¯´è€Œå·²ã€‚è¿™ä»½çˆ±ï¼Œä¼šéšç€æ—¶é—´è¶Šæ¥è¶Šæ·±ï¼Œè¶Šæ¥è¶Šæµ“ã€‚

æƒ…äººèŠ‚å¿«ä¹ï¼Œæˆ‘çš„å°å®è´ã€‚æ„¿æˆ‘ä»¬çš„çˆ±æƒ…ï¼Œæ°¸è¿œåƒä»Šå¤©ä¸€æ ·ç”œèœœã€‚

 Forever Yours,
 ä½ çˆ±çš„ä¸»äºº`;

        // ==========================================
        // ä»¥ä¸‹æ˜¯ç¨‹åºä»£ç ï¼Œä¸€èˆ¬ä¸éœ€è¦ä¿®æ”¹
        // ==========================================

        // åˆå§‹åŒ–å˜é‡
        let isMusicPlaying = true; // æ”¹ä¸º trueï¼Œå› ä¸ºé»˜è®¤è‡ªåŠ¨æ’­æ”¾
        let typingTimeout = null;
        let currentCharIndex = 0;
        const letterContent = document.getElementById('letter-content');
        const typingCursor = document.getElementById('typing-cursor');
        const letterBody = document.getElementById('letter-body');  // ä¿¡ä»¶æ­£æ–‡å®¹å™¨
        const viewLetterBtn = document.getElementById('view-letter-btn');  // æŸ¥çœ‹ä¿¡ä»¶æŒ‰é’®
        const musicBtn = document.getElementById('music-btn');
        const bgMusic = document.getElementById('bg-music');
        const fireworkBtn = document.getElementById('firework-btn');
        const replayBtn = document.getElementById('replay-btn');
        const heartTrigger = document.getElementById('heart-trigger');
        const heartsContainer = document.getElementById('hearts-container');
        const canvas = document.getElementById('fireworks-canvas');
        const ctx = canvas.getContext('2d');
        const themeToggle = document.getElementById('theme-toggle');

        // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
        function initTheme() {
            // æ£€æŸ¥æœ¬åœ°å­˜å‚¨çš„ä¸»é¢˜åå¥½
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            if (currentTheme === 'dark') {
                document.documentElement.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
            } else {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
            }
        }

        // åˆå§‹åŒ–ä¸»é¢˜
        initTheme();

        // ä¸»é¢˜åˆ‡æ¢æŒ‰é’®äº‹ä»¶
        themeToggle.addEventListener('click', function(e) {
            e.stopPropagation();
            toggleTheme();
        });

        // è®¾ç½®ç”»å¸ƒå°ºå¯¸
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // æ‰“å­—æœºæ•ˆæœ
        function typeWriter() {
            if (currentCharIndex < loveLetter.length) {
                // åœ¨å…‰æ ‡å‰æ’å…¥æ–‡å­—èŠ‚ç‚¹ï¼Œä½¿å…‰æ ‡è·Ÿéšæ–‡å­—
                const textNode = document.createTextNode(loveLetter.charAt(currentCharIndex));
                letterContent.insertBefore(textNode, typingCursor);
                currentCharIndex++;
                
                // æ ¹æ®å­—ç¬¦ç±»å‹è°ƒæ•´å»¶è¿Ÿ
                let delay = 90;
                const char = loveLetter.charAt(currentCharIndex - 1);
                if (char === 'ã€‚' || char === 'ï¼' || char === 'ï¼Ÿ') {
                    delay = 300;
                } else if (char === 'ï¼Œ' || char === 'ã€') {
                    delay = 150;
                } else if (char === '\n') {
                    delay = 260;
                }
                
                typingTimeout = setTimeout(typeWriter, delay);
            } else {
                typingCursor.style.display = 'none';
            }
        }

        // åˆ›å»ºé£˜è½çˆ±å¿ƒ
        function createFallingHeart() {
            const heart = document.createElement('div');
            heart.className = 'falling-heart';
            
            const size = Math.random() * 20 + 15;
            const left = Math.random() * 100;
            const duration = Math.random() * 5 + 8;
            const delay = Math.random() * 3;
            
            // éšæœºé¢œè‰²
            const colors = ['#e91e63', '#ff6b9d', '#f48fb1', '#f8bbd9', '#4db6ac'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            heart.innerHTML = `
                <svg width="${size}" height="${size}" viewBox="0 0 24 24" style="fill: ${color}">
                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                </svg>
            `;
            
            heart.style.left = `${left}%`;
            heart.style.animationDuration = `${duration}s`;
            heart.style.animationDelay = `${delay}s`;
            
            heartsContainer.appendChild(heart);
            
            setTimeout(() => {
                heart.remove();
            }, (duration + delay) * 1000);
        }

        // å®šæœŸåˆ›å»ºçˆ±å¿ƒ
        function startHearts() {
            setInterval(() => {
                if (Math.random() > 0.3) {
                    createFallingHeart();
                }
            }, 800);
        }

        // çƒŸèŠ±ç³»ç»Ÿ
        const fireworks = [];
        const particles = [];

        class Firework {
            constructor(sx, sy, tx, ty) {
                this.x = sx;
                this.y = sy;
                this.sx = sx;
                this.sy = sy;
                this.tx = tx;
                this.ty = ty;
                this.distanceToTarget = Math.sqrt(Math.pow(tx - sx, 2) + Math.pow(ty - sy, 2));
                this.distanceTraveled = 0;
                this.coordinates = [];
                this.coordinateCount = 3;
                while (this.coordinateCount--) {
                    this.coordinates.push([this.x, this.y]);
                }
                this.angle = Math.atan2(ty - sy, tx - sx);
                this.speed = 2;
                this.acceleration = 1.05;
                this.brightness = Math.random() * 50 + 50;
                this.targetRadius = 1;
            }

            update(index) {
                this.coordinates.pop();
                this.coordinates.unshift([this.x, this.y]);
                this.speed *= this.acceleration;
                const vx = Math.cos(this.angle) * this.speed;
                const vy = Math.sin(this.angle) * this.speed;
                this.distanceTraveled = Math.sqrt(Math.pow(this.x - this.sx, 2) + Math.pow(this.y - this.sy, 2));
                
                if (this.distanceTraveled >= this.distanceToTarget) {
                    createParticles(this.tx, this.ty);
                    fireworks.splice(index, 1);
                } else {
                    this.x += vx;
                    this.y += vy;
                }
            }

            draw() {
                ctx.beginPath();
                ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
                ctx.lineTo(this.x, this.y);
                ctx.strokeStyle = `hsl(340, 100%, ${this.brightness}%)`;
                ctx.stroke();
            }
        }

        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.coordinates = [];
                this.coordinateCount = 5;
                while (this.coordinateCount--) {
                    this.coordinates.push([this.x, this.y]);
                }
                this.angle = Math.random() * Math.PI * 2;
                this.speed = Math.random() * 10 + 1;
                this.friction = 0.95;
                this.gravity = 1;
                this.decay = Math.random() * 0.03 + 0.01;
                this.alpha = 1;
                this.hue = Math.random() * 60 + 330; // ç²‰è‰²åˆ°çº¢è‰²èŒƒå›´
                if (Math.random() > 0.5) {
                    this.hue = Math.random() * 40 + 170; // é’è“è‰²èŒƒå›´
                }
                // æ·±è‰²æ¨¡å¼ä¸‹å¢åŠ æ›´å¤šé¢œè‰²å˜åŒ–
                if (document.documentElement.getAttribute('data-theme') === 'dark') {
                    const colorChoice = Math.random();
                    if (colorChoice < 0.25) {
                        this.hue = Math.random() * 60 + 330; // ç²‰çº¢
                    } else if (colorChoice < 0.5) {
                        this.hue = Math.random() * 40 + 170; // é’è“
                    } else if (colorChoice < 0.75) {
                        this.hue = Math.random() * 60 + 270; // ç´«è‰²
                    } else {
                        this.hue = Math.random() * 40 + 30; // é‡‘é»„
                    }
                }
            }

            update(index) {
                this.coordinates.pop();
                this.coordinates.unshift([this.x, this.y]);
                this.speed *= this.friction;
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed + this.gravity;
                this.alpha -= this.decay;

                if (this.alpha <= this.decay) {
                    particles.splice(index, 1);
                }
            }

            draw() {
                ctx.beginPath();
                ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
                ctx.lineTo(this.x, this.y);
                ctx.strokeStyle = `hsla(${this.hue}, 100%, 65%, ${this.alpha})`;
                ctx.lineWidth = 2;
                ctx.stroke();
            }
        }

        function createParticles(x, y) {
            const particleCount = 80;
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle(x, y));
            }
        }

        function launchFirework(x, y) {
            const targetX = x || Math.random() * canvas.width;
            const targetY = y || Math.random() * canvas.height * 0.5;
            const startX = canvas.width / 2;
            const startY = canvas.height;
            fireworks.push(new Firework(startX, startY, targetX, targetY));
        }

        let animationId = null;

        function animateFireworks() {
            animationId = requestAnimationFrame(animateFireworks);
            ctx.globalCompositeOperation = 'destination-out';
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.globalCompositeOperation = 'lighter';

            for (let i = fireworks.length - 1; i >= 0; i--) {
                fireworks[i].draw();
                fireworks[i].update(i);
            }

            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].draw();
                particles[i].update(i);
            }
        }

        // éŸ³ä¹æ§åˆ¶
        function toggleMusic() {
            if (isMusicPlaying) {
                bgMusic.pause();
                musicBtn.querySelector('span').textContent = 'æ’­æ”¾éŸ³ä¹';
                musicBtn.classList.remove('music-playing');
            } else {
                bgMusic.play().catch(e => {
                    console.log('éŸ³ä¹æ’­æ”¾éœ€è¦ç”¨æˆ·äº¤äº’');
                });
                musicBtn.querySelector('span').textContent = 'æš‚åœéŸ³ä¹';
                musicBtn.classList.add('music-playing');
            }
            isMusicPlaying = !isMusicPlaying;
        }

        // å¤šå‘çƒŸèŠ±
        function launchMultipleFireworks() {
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    launchFirework();
                }, i * 200);
            }
        }

        // äº‹ä»¶ç›‘å¬
        musicBtn.addEventListener('click', toggleMusic);
        fireworkBtn.addEventListener('click', launchMultipleFireworks);
        replayBtn.addEventListener('click', replayLetter);
        
        heartTrigger.addEventListener('click', function(e) {
            launchMultipleFireworks();
        });

        // ç‚¹å‡»å±å¹•æ”¾çƒŸèŠ±
        document.addEventListener('click', function(e) {
            // æ’é™¤æŒ‰é’®ç‚¹å‡»
            if (e.target.closest('.control-btn') || e.target.closest('.heartbeat-container') || e.target.closest('.theme-toggle')) {
                return;
            }
            launchFirework(e.clientX, e.clientY);
        });

        // ç‚¹å‡»æŒ‰é’®å±•å¼€ä¿¡ä»¶
        function showLetter() {
            viewLetterBtn.classList.add('hidden');  // éšè—æŒ‰é’®
            letterBody.classList.remove('hidden');  // ç§»é™¤éšè—ç±»
            letterBody.classList.add('visible');   // æ·»åŠ æ˜¾ç¤ºåŠ¨ç”»ç±»
            // æ¸…é™¤å…‰æ ‡ä¹‹å‰çš„æ‰€æœ‰èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬ç©ºç™½æ–‡æœ¬èŠ‚ç‚¹å’Œæ³¨é‡Šï¼‰
            while (letterContent.firstChild && letterContent.firstChild !== typingCursor) {
                letterContent.removeChild(letterContent.firstChild);
            }
            typingCursor.style.display = 'inline-block';  // æ˜¾ç¤ºå…‰æ ‡
            // å»¶è¿Ÿå¼€å§‹æ‰“å­—
            setTimeout(typeWriter, 300);
        }

        // é‡æ’­ä¿¡ä»¶ï¼ˆé‡ç½®æŒ‰é’®çŠ¶æ€ï¼‰
        function replayLetter() {
            if (typingTimeout) {
                clearTimeout(typingTimeout);
            }
            currentCharIndex = 0;
            showLetter();
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            startHearts();
            animateFireworks();
            
            // ä¸å†è‡ªåŠ¨å¼€å§‹æ‰“å­—ï¼Œç­‰å¾…ç”¨æˆ·ç‚¹å‡»æŒ‰é’®
            // setTimeout(typeWriter, 1000);  // å·²ç§»é™¤
            
            // ç»‘å®šæŸ¥çœ‹ä¿¡ä»¶æŒ‰é’®äº‹ä»¶
            viewLetterBtn.addEventListener('click', showLetter);
            
            // åˆå§‹çƒŸèŠ±
            setTimeout(() => {
                launchMultipleFireworks();
            }, 500);

            // è‡ªåŠ¨æ’­æ”¾éŸ³ä¹
            bgMusic.play().then(() => {
                // æ’­æ”¾æˆåŠŸï¼Œæ›´æ–°æŒ‰é’®çŠ¶æ€
                musicBtn.querySelector('span').textContent = 'æš‚åœéŸ³ä¹';
                musicBtn.classList.add('music-playing');
                isMusicPlaying = true;
            }).catch(e => {
                // æµè§ˆå™¨é˜»æ­¢è‡ªåŠ¨æ’­æ”¾ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’åæ’­æ”¾
                console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œç­‰å¾…ç”¨æˆ·äº¤äº’');
                musicBtn.querySelector('span').textContent = 'æ’­æ”¾éŸ³ä¹';
                musicBtn.classList.remove('music-playing');
                isMusicPlaying = false;
                
                // åœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡ç‚¹å‡»é¡µé¢æ—¶å°è¯•æ’­æ”¾
                const playOnFirstClick = () => {
                    bgMusic.play().then(() => {
                        musicBtn.querySelector('span').textContent = 'æš‚åœéŸ³ä¹';
                        musicBtn.classList.add('music-playing');
                        isMusicPlaying = true;
                    }).catch(err => console.log('æ’­æ”¾å¤±è´¥:', err));
                    document.removeEventListener('click', playOnFirstClick);
                };
                document.addEventListener('click', playOnFirstClick);
            });
        });

        // é¡µé¢å¯è§æ€§å˜åŒ–æ—¶æš‚åœ/æ¢å¤åŠ¨ç”»
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                if (animationId) {
                    cancelAnimationFrame(animationId);
                }
            } else {
                animateFireworks();
            }
        });
    </script>
</body>
</html>